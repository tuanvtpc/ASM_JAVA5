<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description"
	content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
<meta name="author" content="AdminKit">
<meta name="keywords"
	content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

<link rel="preconnect" href="https://fonts.gstatic.com">
<link rel="shortcut icon" href="img/icons/icon-48x48.png" />

<link rel="canonical"
	href="https://demo-basic.adminkit.io/pages-profile.html" />

<title>Profile | AdminKit Demo</title>

<link href="/images/static/css/app.css" rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
	crossorigin="anonymous">
<script
	src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
<link
	href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap"
	rel="stylesheet">
</head>

<body>
	<div class="wrapper">
		<nav id="sidebar" class="sidebar js-sidebar">
			<div class="sidebar-content js-simplebar">
				<a class="sidebar-brand" href="index.html"> <span
					class="align-middle">AdminController</span>
				</a>

				<ul class="sidebar-nav">
					<li class="sidebar-header">Manage</li>

					<li class="sidebar-item"><a class="sidebar-link"
						href="/admin/dashboard"> <i class="align-middle"
							data-feather="sliders"></i> <span class="align-middle">Dashboard</span>
					</a></li>

					<li class="sidebar-item"><a class="sidebar-link"
						href="/admin/user"> <i class="align-middle"
							data-feather="user"></i> <span class="align-middle">User</span>
					</a></li>

					<li class="sidebar-item"><a class="sidebar-link active"
						href="/admin/order"> <i class="align-middle"
							data-feather="shopping-bag"></i> <span class="align-middle">Order</span>
					</a></li>

					<li class="sidebar-item active"><a class="sidebar-link active"
						href="/admin/product"> <i class="align-middle"
							data-feather="package"></i> <span class="align-middle">Product</span>
					</a></li>

					<li class="sidebar-item"><a class="sidebar-link"
						href="/admin/category"> <i class="align-middle"
							data-feather="database"></i> <span class="align-middle">Category</span>
					</a></li>
				</ul>
			</div>
		</nav>

		<div class="main">
			<nav class="navbar navbar-expand navbar-light navbar-bg">
				<a class="sidebar-toggle js-sidebar-toggle"> <i
					class="hamburger align-self-center"></i>
				</a>

				<div class="navbar-collapse collapse">
					<ul class="navbar-nav navbar-align">
						<li class="nav-item dropdown"><a
							class="nav-icon dropdown-toggle" href="#" id="alertsDropdown"
							data-bs-toggle="dropdown">
								<div class="position-relative">
									<i class="align-middle" data-feather="bell"></i> <span
										class="indicator">4</span>
								</div>
						</a>
							<div
								class="dropdown-menu dropdown-menu-lg dropdown-menu-end py-0"
								aria-labelledby="alertsDropdown">
								<div class="dropdown-menu-header">4 New Notifications</div>
								<div class="list-group">
									<a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<i class="text-danger" data-feather="alert-circle"></i>
											</div>
											<div class="col-10">
												<div class="text-dark">Update completed</div>
												<div class="text-muted small mt-1">Restart server 12
													to complete the update.</div>
												<div class="text-muted small mt-1">30m ago</div>
											</div>
										</div>
									</a> <a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<i class="text-warning" data-feather="bell"></i>
											</div>
											<div class="col-10">
												<div class="text-dark">Lorem ipsum</div>
												<div class="text-muted small mt-1">Aliquam ex eros,
													imperdiet vulputate hendrerit et.</div>
												<div class="text-muted small mt-1">2h ago</div>
											</div>
										</div>
									</a> <a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<i class="text-primary" data-feather="home"></i>
											</div>
											<div class="col-10">
												<div class="text-dark">Login from 192.186.1.8</div>
												<div class="text-muted small mt-1">5h ago</div>
											</div>
										</div>
									</a> <a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<i class="text-success" data-feather="user-plus"></i>
											</div>
											<div class="col-10">
												<div class="text-dark">New connection</div>
												<div class="text-muted small mt-1">Christina accepted
													your request.</div>
												<div class="text-muted small mt-1">14h ago</div>
											</div>
										</div>
									</a>
								</div>
								<div class="dropdown-menu-footer">
									<a href="#" class="text-muted">Show all notifications</a>
								</div>
							</div></li>
						<li class="nav-item dropdown"><a
							class="nav-icon dropdown-toggle" href="#" id="messagesDropdown"
							data-bs-toggle="dropdown">
								<div class="position-relative">
									<i class="align-middle" data-feather="message-square"></i>
								</div>
						</a>
							<div
								class="dropdown-menu dropdown-menu-lg dropdown-menu-end py-0"
								aria-labelledby="messagesDropdown">
								<div class="dropdown-menu-header">
									<div class="position-relative">4 New Messages</div>
								</div>
								<div class="list-group">
									<a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<img src="img/avatars/avatar-5.jpg"
													class="avatar img-fluid rounded-circle"
													alt="Vanessa Tucker">
											</div>
											<div class="col-10 ps-2">
												<div class="text-dark">Vanessa Tucker</div>
												<div class="text-muted small mt-1">Nam pretium turpis
													et arcu. Duis arcu tortor.</div>
												<div class="text-muted small mt-1">15m ago</div>
											</div>
										</div>
									</a> <a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<img src="img/avatars/avatar-2.jpg"
													class="avatar img-fluid rounded-circle"
													alt="William Harris">
											</div>
											<div class="col-10 ps-2">
												<div class="text-dark">William Harris</div>
												<div class="text-muted small mt-1">Curabitur ligula
													sapien euismod vitae.</div>
												<div class="text-muted small mt-1">2h ago</div>
											</div>
										</div>
									</a> <a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<img src="img/avatars/avatar-4.jpg"
													class="avatar img-fluid rounded-circle"
													alt="Christina Mason">
											</div>
											<div class="col-10 ps-2">
												<div class="text-dark">Christina Mason</div>
												<div class="text-muted small mt-1">Pellentesque auctor
													neque nec urna.</div>
												<div class="text-muted small mt-1">4h ago</div>
											</div>
										</div>
									</a> <a href="#" class="list-group-item">
										<div class="row g-0 align-items-center">
											<div class="col-2">
												<img src="img/avatars/avatar-3.jpg"
													class="avatar img-fluid rounded-circle"
													alt="Sharon Lessman">
											</div>
											<div class="col-10 ps-2">
												<div class="text-dark">Sharon Lessman</div>
												<div class="text-muted small mt-1">Aenean tellus
													metus, bibendum sed, posuere ac, mattis non.</div>
												<div class="text-muted small mt-1">5h ago</div>
											</div>
										</div>
									</a>
								</div>
								<div class="dropdown-menu-footer">
									<a href="#" class="text-muted">Show all messages</a>
								</div>
							</div></li>
						<li class="nav-item dropdown"><a
							class="nav-icon dropdown-toggle d-inline-block d-sm-none"
							href="#" data-bs-toggle="dropdown"> <i class="align-middle"
								data-feather="settings"></i>
						</a> <a class="nav-link dropdown-toggle d-none d-sm-inline-block"
							href="#" data-bs-toggle="dropdown"> <img
								src="img/avatars/avatar.jpg"
								class="avatar img-fluid rounded me-1" alt="Charles Hall" /> <span
								class="text-dark">Charles Hall</span>
						</a>
							<div class="dropdown-menu dropdown-menu-end">
								<a class="dropdown-item" href="pages-profile.html"><i
									class="align-middle me-1" data-feather="user"></i> Profile</a> <a
									class="dropdown-item" href="#"><i class="align-middle me-1"
									data-feather="pie-chart"></i> Analytics</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="index.html"><i
									class="align-middle me-1" data-feather="settings"></i> Settings
									& Privacy</a> <a class="dropdown-item" href="#"><i
									class="align-middle me-1" data-feather="help-circle"></i> Help
									Center</a>
								<div class="dropdown-divider"></div>
								<a class="dropdown-item" href="#">Log out</a>
							</div></li>
					</ul>
				</div>
			</nav>

			<main class="content">
				<div class="container-fluid p-0">

					<div class="mb-3 d-flex justify-content-between align-items-center">
						<!-- Nút Add user -->
						<a href="/admin/product-form" class="btn btn-success">Add
							Product</a>

						<!-- Thanh tìm kiếm -->
						<form method="get" action="/admin/product" class="d-flex gap-2">
							<input type="text" class="form-control" name="search"
								th:value="${search}" placeholder="Nhập tên sản phẩm...">
							<button type="submit" class="btn btn-outline-primary">Tìm
								kiếm</button>
						</form>
						<!-- Modal Form cho Giá -->
						<div class="modal fade" id="editPriceModal" tabindex="-1"
							aria-labelledby="editPriceModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="editPriceModalLabel">Chỉnh
											sửa giá</h5>
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="editPriceForm">
											<input type="hidden" id="editPriceProductId" name="id">
											<div class="mb-3">
												<label for="editPriceInput" class="form-label">Giá
													bán</label> <input type="number" class="form-control"
													id="editPriceInput" name="price" required>
											</div>
										</form>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">Đóng</button>
										<button type="button" class="btn btn-primary"
											onclick="updatePrice()">Lưu thay đổi</button>
									</div>
								</div>
							</div>
						</div>

						<!-- Modal Form cho Số Lượng -->
						<div class="modal fade" id="editQuantityModal" tabindex="-1"
							aria-labelledby="editQuantityModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="editQuantityModalLabel">Chỉnh
											sửa số lượng</h5>
										<button type="button" class="btn-close"
											data-bs-dismiss="modal" aria-label="Close"></button>
									</div>
									<div class="modal-body">
										<form id="editQuantityForm">
											<input type="hidden" id="editQuantityProductId" name="id">
											<div class="mb-3">
												<label for="editQuantityInput" class="form-label">Số
													lượng</label> <input type="number" class="form-control"
													id="editQuantityInput" name="quantity" required>
											</div>
										</form>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-secondary"
											data-bs-dismiss="modal">Đóng</button>
										<button type="button" class="btn btn-primary"
											onclick="updateQuantity()">Lưu thay đổi</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row"></div>

					<div class="row">
						<div class="card flex-fill">
							<table class="table table-hover my-0">
								<thead>
									<tr>
										<th>Hình Ảnh</th>
										<th class="d-none d-xl-table-cell">Tên Sản Phẩm</th>
										<th>Giá Bán</th>
										<th>Số Lượng</th>
										<th class="d-none d-md-table-cell">Danh Mục</th>
										<th class="d-none d-xl-table-cell">Ngày Thêm</th>
										<th class="d-none d-md-table-cell">Trạng Thái</th>
										<th>Hành Động</th>
									</tr>
								</thead>
								<tbody>
									<th:block th:each="product : ${productList}">
										<tr>
											<td><th:block
													th:if="${product.images != null and !product.images.isEmpty()}">
													<img
														th:src="@{'/images/' + ${product.images[0].imageName}}"
														style="width: 50px; height: 50px;">
												</th:block> <th:block
													th:unless="${product.images != null and !product.images.isEmpty()}">
													<img src="/images/default.jpg"
														style="width: 50px; height: 50px;">
												</th:block></td>
											<td class="d-none d-xl-table-cell" th:text="${product.name}"></td>
											<td><span th:text="${product.price} + ' VND'"
												th:attr="onclick='openEditPriceModal(' + ${product.id} + ', ' + ${product.price} + ')'"
												style="cursor: pointer;"> </span></td>
											<td><span th:text="${product.quantity}"
												th:attr="onclick='openEditQuantityModal(' + ${product.id} + ', ' + ${product.quantity} + ')'"
												style="cursor: pointer;"> </span></td>
											<td class="d-none d-md-table-cell"
												th:text="${product.category.name}"></td>
											<td class="d-none d-xl-table-cell"
												th:text="${product.dateCreated}"></td>
											<td class="d-none d-md-table-cell"><span
												th:classappend="${product.isActive} ? 'bg-success' : 'bg-danger'"
												class="badge"
												th:text="${product.isActive} ? 'Đang kinh doanh' : 'Ngừng kinh doanh'"
												onclick="confirmUpdateStatus(${product.id}, ${product.isActive})"
												style="cursor: pointer;"> </span></td>
											<td><a id="id" class="btn btn-success"
												th:href="${'/admin/product-form?id=' + product.id}">SỬA</a>
												<script>
													function confirmDelete() {
														return confirm("Bạn có chắc chắn muốn xóa sản phẩm này?");
													}
												</script>
												<form method="post" action="/admin/delete-product"
													onsubmit="return confirmDelete()">
													<input name="id" th:value="${product.id}" type="hidden" />
													<button class="btn btn-danger">XÓA</button>
												</form>
										</tr>
									</th:block>
								</tbody>
							</table>
						</div>
					</div>

				</div>
			</main>

			<footer class="footer">
				<div class="container-fluid">
					<div class="row text-muted">
						<div class="col-6 text-start">
							<p class="mb-0">
								<a class="text-muted" href="https://adminkit.io/"
									target="_blank"><strong>Admin</strong></a> - <a
									class="text-muted" href="#" target="_blank"><strong>Flower
										Conner</strong></a> &copy;
							</p>
						</div>
						<div class="col-6 text-end">
							<ul class="list-inline">
								<li class="list-inline-item"><a class="text-muted" href="#"
									target="_blank">Support</a></li>
								<li class="list-inline-item"><a class="text-muted" href="#"
									target="_blank">Help Center</a></li>
								<li class="list-inline-item"><a class="text-muted" href="#"
									target="_blank">Privacy</a></li>
								<li class="list-inline-item"><a class="text-muted" href="#"
									target="_blank">Terms</a></li>
							</ul>
						</div>
					</div>
				</div>
			</footer>
		</div>
	</div>
	<script>
  // Mở modal chỉnh sửa giá
  function openEditPriceModal(id, price) {
    document.getElementById('editPriceProductId').value = id;
    document.getElementById('editPriceInput').value = price;
    new bootstrap.Modal(document.getElementById('editPriceModal')).show();
  }

  // Gửi yêu cầu cập nhật giá
  function updatePrice() {
    const form = document.getElementById('editPriceForm');
    const formData = new FormData(form);

    fetch('/admin/update-product-price', {
      method: 'POST',
      body: formData
    })
    .then(response => {
      if (response.ok) {
        location.reload(); // Tải lại trang sau khi cập nhật thành công
      } else {
        alert('Cập nhật giá thất bại!');
      }
    })
    .catch(error => {
      console.error('Lỗi:', error);
    });
  }

  // Mở modal chỉnh sửa số lượng
  function openEditQuantityModal(id, quantity) {
    document.getElementById('editQuantityProductId').value = id;
    document.getElementById('editQuantityInput').value = quantity;
    new bootstrap.Modal(document.getElementById('editQuantityModal')).show();
  }

  // Gửi yêu cầu cập nhật số lượng
  function updateQuantity() {
    const form = document.getElementById('editQuantityForm');
    const formData = new FormData(form);

    fetch('/admin/update-product-quantity', {
      method: 'POST',
      body: formData
    })
    .then(response => {
      if (response.ok) {
        location.reload(); // Tải lại trang sau khi cập nhật thành công
      } else {
        alert('Cập nhật số lượng thất bại!');
      }
    })
    .catch(error => {
      console.error('Lỗi:', error);
    });
  }

  // Xác nhận và cập nhật trạng thái
  function confirmUpdateStatus(id, isActive) {
    const newStatus = !isActive; // Đảo ngược trạng thái hiện tại
    const confirmMessage = `Bạn có muốn ${newStatus ? 'kích hoạt' : 'ngừng kinh doanh'} sản phẩm này không?`;

    if (confirm(confirmMessage)) {
      fetch(`/admin/update-product-status?id=${id}&isActive=${newStatus}`, {
        method: 'POST'
      })
      .then(response => {
        if (response.ok) {
          location.reload(); // Tải lại trang sau khi cập nhật thành công
        } else {
          alert('Cập nhật trạng thái thất bại!');
        }
      })
      .catch(error => {
        console.error('Lỗi:', error);
      });
    }
  }
</script>

	<script src="/images/static/js/app.js"></script>

</body>

</html>